<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"/>
    <title>动态规划 | Siren&#39;s playground</title>
    <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon_io/favicon-16x16.png">
    <link rel="manifest" href="/images/favicon_io/site.webmanifest">
    <meta name="generator" content="VuePress 1.8.2"/>
    
    <meta name="description" content="Paint the world colorful.">
    
    <link rel="preload" href="/assets/css/0.styles.9c74bf75.css" as="style"><link rel="preload" href="/assets/js/app.ea9d4954.js" as="script"><link rel="preload" href="/assets/js/4.28869c9a.js" as="script"><link rel="preload" href="/assets/js/9.bd309bf5.js" as="script"><link rel="preload" href="/assets/js/17.bc4d0f2d.js" as="script"><link rel="prefetch" href="/assets/js/10.c3dd7cab.js"><link rel="prefetch" href="/assets/js/11.cf8595e3.js"><link rel="prefetch" href="/assets/js/12.84e6e87e.js"><link rel="prefetch" href="/assets/js/13.40499fb6.js"><link rel="prefetch" href="/assets/js/14.d5fbbcf8.js"><link rel="prefetch" href="/assets/js/15.1027496f.js"><link rel="prefetch" href="/assets/js/16.1df90763.js"><link rel="prefetch" href="/assets/js/18.8dd7f229.js"><link rel="prefetch" href="/assets/js/19.c0c937e1.js"><link rel="prefetch" href="/assets/js/20.fa9a53fe.js"><link rel="prefetch" href="/assets/js/21.ed0e9ca8.js"><link rel="prefetch" href="/assets/js/22.c8fde21a.js"><link rel="prefetch" href="/assets/js/23.699ba066.js"><link rel="prefetch" href="/assets/js/24.f24efa36.js"><link rel="prefetch" href="/assets/js/25.3ee32f80.js"><link rel="prefetch" href="/assets/js/26.f3986fb4.js"><link rel="prefetch" href="/assets/js/27.2ba67cb0.js"><link rel="prefetch" href="/assets/js/28.bc37af14.js"><link rel="prefetch" href="/assets/js/29.53a30d46.js"><link rel="prefetch" href="/assets/js/30.9038a4b3.js"><link rel="prefetch" href="/assets/js/31.c0130109.js"><link rel="prefetch" href="/assets/js/32.c0c8e8c8.js"><link rel="prefetch" href="/assets/js/33.cd00c508.js"><link rel="prefetch" href="/assets/js/34.59b8778d.js"><link rel="prefetch" href="/assets/js/35.6e412373.js"><link rel="prefetch" href="/assets/js/36.41a4923b.js"><link rel="prefetch" href="/assets/js/37.9a4f30e2.js"><link rel="prefetch" href="/assets/js/38.a305f461.js"><link rel="prefetch" href="/assets/js/39.318649e3.js"><link rel="prefetch" href="/assets/js/40.4894d1aa.js"><link rel="prefetch" href="/assets/js/41.0d7a8cab.js"><link rel="prefetch" href="/assets/js/42.feb16f75.js"><link rel="prefetch" href="/assets/js/43.c3f9982c.js"><link rel="prefetch" href="/assets/js/44.f3f5d56e.js"><link rel="prefetch" href="/assets/js/45.9288431f.js"><link rel="prefetch" href="/assets/js/46.7558e946.js"><link rel="prefetch" href="/assets/js/47.762f57e7.js"><link rel="prefetch" href="/assets/js/48.f5b15b7d.js"><link rel="prefetch" href="/assets/js/49.8fe97b65.js"><link rel="prefetch" href="/assets/js/5.286a4fa0.js"><link rel="prefetch" href="/assets/js/50.5f6bb086.js"><link rel="prefetch" href="/assets/js/51.ddd2835d.js"><link rel="prefetch" href="/assets/js/52.972cf541.js"><link rel="prefetch" href="/assets/js/53.bc230099.js"><link rel="prefetch" href="/assets/js/54.97356cb8.js"><link rel="prefetch" href="/assets/js/55.b365130c.js"><link rel="prefetch" href="/assets/js/56.79894336.js"><link rel="prefetch" href="/assets/js/57.8c20a954.js"><link rel="prefetch" href="/assets/js/6.2d9706cf.js"><link rel="prefetch" href="/assets/js/7.d592bd06.js"><link rel="prefetch" href="/assets/js/8.aff6e7ee.js"><link rel="prefetch" href="/assets/js/vendors~flowchart.d641e664.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.9c62f2f4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.9c74bf75.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><div class="theme-sidebar"><div class="theme-sidebar__inner"><div class="theme-header"><ul class="floating-squares"><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li><li></li></ul> <a href="/" class="theme-header__logo router-link-active"><img draggable="false" src="/logo.jpg" alt="logo" width="160" height="160" class="theme-header__picture"> <div class="theme-palette"><span class="theme-palette__emoji"><svg class="theme-icon theme-icon-palette"><use xlink:href="#theme-icon-palette"></use></svg></span> <div class="theme-palette__list"><a href="javascript:;" title="#ffa1a1" style="color:#ffa1a1;"></a><a href="javascript:;" title="#d8caaf" style="color:#d8caaf;"></a><a href="javascript:;" title="#965455" style="color:#965455;"></a><a href="javascript:;" title="#6b5152" style="color:#6b5152;"></a><a href="javascript:;" title="#7a7281" style="color:#7a7281;"></a></div></div></a> <a href="/" class="theme-header__name router-link-active">
        Siren's playground
      </a> <p class="theme-header__slogan">Paint the world colorful.</p></div> <div class="theme-SubNav"><a href="/categories/" class="theme-SubNav__item"><span class="theme-SubNav__count">12</span> <span class="theme-SubNav__name">Categories</span></a> <a href="/tags/" class="theme-SubNav__item"><span class="theme-SubNav__count">8</span> <span class="theme-SubNav__name">Tags</span></a> <a href="/archives/" class="theme-SubNav__item"><span class="theme-SubNav__count">42</span> <span class="theme-SubNav__name">Archives</span></a></div> <div class="theme-nav"><div class="search-box mt-7"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links"><div><div class="nav-item"><a href="/" class="nav-link">
  Home
</a></div><div class="nav-item"><a href="/blogs/" class="nav-link">
  Blogs
</a></div><div class="nav-item"><a href="/friend-links/" class="nav-link">
  Let's Connect
</a></div></div> <!----></nav></div> <div class="theme-footer"><div class="social-links"><a target="_blank" rel="external nofollow noopener" title="email" href="mailto:siren.xrw@gmail.com" class="icon-email">email</a><a target="_blank" rel="external nofollow noopener" title="github" href="https://github.com/sirenar" class="icon-github">github</a><a target="_blank" rel="external nofollow noopener" title="qq" href="https://qm.qq.com/cgi-bin/qm/qr?k=KJY-Ba59H1bP-2vQcM0KqxZY2tZkVayT&amp;noverify=0" class="icon-qq">qq</a><a target="_blank" rel="external nofollow noopener" title="feed" href="/rss.xml" class="icon-feed">feed</a></div> <p class="copyright">© 2024 <a target="_blank" href="#">Siren Wang</a></p> <p class="powered"><span>Powered by <a href="https://vuepress.vuejs.org" target="_blank" rel="external nofollow noopener">VuePress</a></span></p></div></div></div> <div class="theme-main"><div class="theme-main__inner post"><article itemscope="itemscope" itemtype="https://schema.org/BlogPosting"><header class="article__header--hasCover" style="background-image:url(/images/fib-dp.png);"><div class="article__header-con"><div class="post-meta post-meta--hasCover"><!----> <div class="post-meta__date"><i class="icon-calendar"></i> <time pubdate itemprop="datePublished" datetime="2021-09-20T00:00:00.000Z">
      Sep 20, 2021
    </time></div> <div class="post-meta__cates"><i class="icon-cate"></i> <a href="/categories/Algorithms/">
      Algorithms
    </a></div> <div class="post-meta__reading"><i class="icon-time"></i>
    7.6k words in 28 min
  </div> <div id="" data-flag-title="Your Article Title" class="leancloud_visitors"><i class="icon-eye"></i> <span class="leancloud-visitors-count">--</span>visited
  </div></div> <hr class="article-hr"> <h1 itemprop="name headline" class="post-title">
          动态规划
        </h1></div></header> <div class="article-con"><div itemprop="articleBody" class="article-content copy-code-enabled content__default"><blockquote><p>将大问题分解为小问题。</p></blockquote> <p><img src="/images/dp-mindmap.png" alt=""></p> <h3 id="贪心算法"><a href="#贪心算法" class="header-anchor">#</a> 贪心算法</h3> <h4 id="硬币找零问题"><a href="#硬币找零问题" class="header-anchor">#</a> 硬币找零问题</h4> <p>给定n种不同面值的硬币，分别记为c[0], c[1], c[2], … c[n]，同时还有一个总金额k，编写一个函数计算出最少需要几枚硬币凑出这个金额k？每种硬币的个数不限，且如果没有任何一种硬币组合能组成总金额时，返回 -1。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>示例 1：

输入：c[0]=1, c[1]=2, c[2]=5, k=12
输出：3 
解释：12 = 5 + 5 + 2

示例 2：

输入：c[0]=5, k=7
输出：-1
解释：只有一种面值为5的硬币，怎么都无法凑出总价值为7的零钱。
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>题目中有一个醒目的提示词，那就是“最少”。</p> <p>举个简单的例子，按照示例1的题设，有三种不同面值的硬币，分别为c1=1, c2=2, c3=5，在没有“最少”这一前提条件下你能罗列出几种不同的答案？我在这里随意列出几个：</p> <p>解1：输出：5，因为 5 + 2 + 2 + 2 + 1 = 12。
解2：输出：6，因为 2 + 2 + 2 + 2 + 2 + 2 = 12。
解3：输出：12，因为 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 + 1 = 12。
所以，这是一个求最值的问题。那么求最值的核心问题是什么呢？嗯，无非就是穷举，显然，就是把所有可能的凑硬币方法都穷举出来，然后找找看最少需要多少枚硬币，那么最少的凑法，就是这道题目的答案。</p> <p>在面试中，一般来说穷举从来都不是一个好方法。除非你要的结果就是所有的不同组合，而不是一个最值。但即便是求所有的不同组合，在计算的过程中也仍然会出现重复计算的问题，我们将这种现象称之为重叠子问题。</p> <blockquote><p>重叠子问题：我们在罗列所有可能答案的过程中，可能存在重复计算的情况。</p></blockquote> <h4 id="贪心算法-2"><a href="#贪心算法-2" class="header-anchor">#</a> 贪心算法</h4> <p>贪心算法是指它的每一步计算作出的都是在当前看起来最好的选择，也就是说它所作出的选择只是在某种意义上的局部最优选择，并不从整体最优考虑。在这里，我把这两种选择的思路称作局部最优解和整体最优解。</p> <p>因此，我们可以得到贪心算法的基本思路：</p> <ol><li>根据问题来建立数学模型，一般面试题会定义一个简单模型；</li> <li>把待求解问题划分成若干个子问题，对每个子问题进行求解，得到子问题的局部最优解；</li> <li>把子问题的局部最优解进行合并，得到最后基于局部最优解的一个解，即原问题的答案。</li></ol> <h4 id="解题思路"><a href="#解题思路" class="header-anchor">#</a> 解题思路</h4> <p>既然这道题问的是最少需要几枚硬币凑出金额k，那么是否可以尝试使用贪心的思想来解这个问题呢？从面值最大的硬币开始兑换，最后得出的硬币总数很有可能就是最少的。</p> <p>我们从 c[0]=5, c[1]=3 且k=11 的情况下寻求最少硬币数。按照“贪心原则”，我们先挑选面值最大的，即为5的硬币放入钱包。接着，还有6元待解（即11-5 = 6）。这时，我们再次“贪心”，放入5元面值的硬币。</p> <p><img src="/images/greedy.png" alt="greedy1"></p> <p>结合代码再理解一下算法的执行步骤：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Java Solution</span>
<span class="token keyword">int</span> <span class="token function">getMinCoinCountHelper</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">,</span> <span class="token keyword">int</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rest <span class="token operator">=</span> total<span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 从大到小遍历所有面值</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> valueCount<span class="token punctuation">;</span> <span class="token operator">++</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> currentCount <span class="token operator">=</span> rest <span class="token operator">/</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 计算当前面值最多能用多少个</span>
        rest <span class="token operator">-=</span> currentCount <span class="token operator">*</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 计算使用完当前面值后的余额</span>
        count <span class="token operator">+=</span> currentCount<span class="token punctuation">;</span> <span class="token comment">// 增加当前面额用量</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rest <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 如果到这里说明无法凑出总价，返回-1</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getMinCoinCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总价</span>
    <span class="token keyword">return</span> <span class="token function">getMinCoinCountHelper</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出结果</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p><br><br></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// C++ Solution</span>
<span class="token keyword">int</span> <span class="token function">GetMinCoinCountHelper</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> values<span class="token punctuation">,</span> <span class="token keyword">int</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> rest <span class="token operator">=</span> total<span class="token punctuation">;</span>
    <span class="token keyword">int</span> count <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token comment">// 从大到小遍历所有面值</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> valueCount<span class="token punctuation">;</span> <span class="token operator">++</span> i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> currentCount <span class="token operator">=</span> rest <span class="token operator">/</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 计算当前面值最多能用多少个</span>
        rest <span class="token operator">-=</span> currentCount <span class="token operator">*</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 计算使用完当前面值后的余额</span>
        count <span class="token operator">+=</span> currentCount<span class="token punctuation">;</span> <span class="token comment">// 增加当前面额用量</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>rest <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> count<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// 如果到这里说明无法凑出总价，返回-1</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">GetMinCoinCount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> values<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总价</span>
    <span class="token keyword">return</span> <span class="token function">GetMinCoinCountHelper</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出结果</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>这段代码就是简单地从最大的面值开始尝试，每次都会把当前面值的硬币尽量用光，然后才会尝试下一种面值的货币。</p> <p>嗯。。。你有没有发现问题？那就是还剩1元零钱待找，但是我们只有c[0]=5, c[1]=3两种面值的硬币，怎么办？这个问题无解了，该返回-1了吗？显然不是。</p> <p>我们把第2步放入的5元硬币取出，放入面值为3元的硬币试试看。这时，你就会发现，我们还剩3元零钱待找。</p> <p><img src="/images/greedy2.png" alt="greedy2"></p> <p>正好我们还有c[1]=3的硬币可以使用，因此解是c[0]=5, c[1]=3, c[1]=3，即最少使用三枚硬币凑出了k=11这个金额。</p> <p>我们对贪心算法做了改进，引入了回溯来解决前面碰到的“过于贪心”的问题。同样地，我把改进后的代码贴在这，你可以再看看跟之前算法实现的区别。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Java Solution</span>
<span class="token keyword">int</span> <span class="token function">getMinCoinCountOfValue</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">,</span> <span class="token keyword">int</span> valueIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> valueCount <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>valueIndex <span class="token operator">==</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> minResult <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">int</span> currentValue <span class="token operator">=</span> values<span class="token punctuation">[</span>valueIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> maxCount <span class="token operator">=</span> total <span class="token operator">/</span> currentValue<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> count <span class="token operator">=</span> maxCount<span class="token punctuation">;</span> count <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> count <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> rest <span class="token operator">=</span> total <span class="token operator">-</span> count <span class="token operator">*</span> currentValue<span class="token punctuation">;</span>

        <span class="token comment">// 如果rest为0，表示余额已除尽，组合完成</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rest <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            minResult <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>minResult<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 否则尝试用剩余面值求当前余额的硬币总数</span>
        <span class="token keyword">int</span> restCount <span class="token operator">=</span> <span class="token function">getMinCoinCountOfValue</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> values<span class="token punctuation">,</span> valueIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果后续没有可用组合</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>restCount <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 如果当前面值已经为0，返回-1表示尝试失败</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token comment">// 否则尝试把当前面值-1</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        minResult <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>minResult<span class="token punctuation">,</span> count <span class="token operator">+</span> restCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minResult<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getMinCoinCountLoop</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> minCount <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">int</span> valueCount <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    
    <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>minCount<span class="token punctuation">,</span> <span class="token function">getMinCoinCountOfValue</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> k<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> valueCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// k位置已经排列好</span>
        <span class="token keyword">int</span> t <span class="token operator">=</span> values<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>t<span class="token punctuation">;</span>
        minCount <span class="token operator">=</span> <span class="token class-name">Math</span><span class="token punctuation">.</span><span class="token function">min</span><span class="token punctuation">(</span>minCount<span class="token punctuation">,</span> <span class="token function">getMinCoinCountLoop</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 考虑后一位</span>

        <span class="token comment">// 回溯</span>
        t <span class="token operator">=</span> values<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minCount<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getMinCoinCountOfValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总价</span>
    <span class="token keyword">int</span> minCoin <span class="token operator">=</span> <span class="token function">getMinCoinCountLoop</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span>minCoin <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> minCoin<span class="token punctuation">;</span>  <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br></div></div><p><br><br></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// C++ Solution</span>
<span class="token keyword">int</span> <span class="token function">GetMinCoinCountOfValue</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> values<span class="token punctuation">,</span> <span class="token keyword">int</span> valueIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>valueIndex <span class="token operator">==</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> INT_MAX<span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> minResult <span class="token operator">=</span> INT_MAX<span class="token punctuation">;</span>
    <span class="token keyword">int</span> currentValue <span class="token operator">=</span> values<span class="token punctuation">[</span>valueIndex<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> maxCount <span class="token operator">=</span> total <span class="token operator">/</span> currentValue<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> count <span class="token operator">=</span> maxCount<span class="token punctuation">;</span> count <span class="token operator">&gt;=</span> <span class="token number">0</span><span class="token punctuation">;</span> count <span class="token operator">--</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> rest <span class="token operator">=</span> total <span class="token operator">-</span> count <span class="token operator">*</span> currentValue<span class="token punctuation">;</span>

        <span class="token comment">// 如果rest为0，表示余额已除尽，组合完成</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>rest <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            minResult <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minResult<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">break</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 否则尝试用剩余面值求当前余额的硬币总数</span>
        <span class="token keyword">int</span> restCount <span class="token operator">=</span> <span class="token function">GetMinCoinCountOfValue</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> values<span class="token punctuation">,</span> valueIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> valueCount<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果后续没有可用组合</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>restCount <span class="token operator">==</span> INT_MAX<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 如果当前面值已经为0，返回-1表示尝试失败</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>count <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">break</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
            <span class="token comment">// 否则尝试把当前面值-1</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        minResult <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minResult<span class="token punctuation">,</span> count <span class="token operator">+</span> restCount<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minResult<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">GetMinCoinCountLoop</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token operator">*</span> values<span class="token punctuation">,</span> <span class="token keyword">int</span> valueCount<span class="token punctuation">,</span> <span class="token keyword">int</span> k<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> minCount <span class="token operator">=</span> INT_MAX<span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>k <span class="token operator">==</span> valueCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">min</span><span class="token punctuation">(</span>minCount<span class="token punctuation">,</span> <span class="token function">GetMinCoinCountOfValue</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> valueCount<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> k<span class="token punctuation">;</span> i <span class="token operator">&lt;=</span> valueCount <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// k位置已经排列好</span>
        <span class="token keyword">int</span> t <span class="token operator">=</span> values<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>t<span class="token punctuation">;</span>
        minCount <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minCount<span class="token punctuation">,</span> <span class="token function">GetMinCoinCountOfValue</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> valueCount<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        minCount <span class="token operator">=</span> <span class="token function">min</span><span class="token punctuation">(</span>minCount<span class="token punctuation">,</span> <span class="token function">GetMinCoinCountLoop</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> valueCount<span class="token punctuation">,</span> k <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 考虑后一位</span>

        <span class="token comment">// 回溯</span>
        t <span class="token operator">=</span> values<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">=</span>t<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minCount<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">GetMinCoinCountOfValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span> values<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总价</span>
    <span class="token keyword">int</span> minCoin <span class="token operator">=</span> <span class="token function">GetMinCoinCountLoop</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">return</span> <span class="token punctuation">(</span>minCoin <span class="token operator">==</span> INT_MAX<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> minCoin<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br></div></div><p>改进后的算法实现在之前的基础上增加上了一个回溯过程。简单地说就是多了一个递归，不断尝试用更少的当前面值来拼凑。只要有一个组合成功，我们就返回总数，如果所有组合都尝试失败，就返回-1。</p> <h4 id="贪心算法的局限性"><a href="#贪心算法的局限性" class="header-anchor">#</a> 贪心算法的局限性</h4> <p>从上面这个例子我们可以看出，如果只是简单采用贪心的思路，那么到用完2个5元硬币的时候我们就已经黔驴技穷了——因为剩下的1元无论如何都没法用现在的硬币凑出来。这是什么问题导致的呢？</p> <p>这就是贪心算法所谓的局部最优导致的问题，因为我们每一步都尽量多地使用面值最大的硬币，因为这样数量肯定最小，但是有的时候我们就进入了死胡同，就好比上面这个例子。</p> <p>所谓局部最优，就是只考虑“当前”的最大利益，既不向前多看一步，也不向后多看一步，导致每次都只用当前阶段的最优解。</p> <p>那么如果纯粹采用这种策略我们就永远无法达到整体最优，也就无法求得题目的答案了。至于能得到答案的情况那就是我们走狗屎运了。</p> <p>虽然纯粹的贪心算法作用有限，但是这种求解局部最优的思路在方向上肯定是对的，毕竟所谓的整体最优肯定是从很多个局部最优中选择出来的，因此所有最优化问题的基础都是贪心算法。</p> <p>回到前面的例子，我只不过是在贪心的基础上加入了失败后的回溯，稍微牺牲一点当前利益，仅仅是希望通过下一个硬币面值的局部最优达到最终可行的整体最优。</p> <p>所有贪心的思路就是我们最优化求解的根本思想，所有的方法只不过是针对贪心思路的改进和优化而已。回溯解决的是正确性问题，而动态规划则是解决时间复杂度的问题。</p> <h3 id="贪心算法失效了怎么办"><a href="#贪心算法失效了怎么办" class="header-anchor">#</a> 贪心算法失效了怎么办</h3> <h4 id="从最优化问题到递归"><a href="#从最优化问题到递归" class="header-anchor">#</a> 从最优化问题到递归</h4> <p>贪心算法失效的很大一个原因在于它明显的局限性：它几乎只考虑局部最优解。所谓局部最优，就是只考虑当前的最大利益，既不向前多看一步，也不向后多看一步，导致每次都只用当前阶段的最优解。</p> <p>因此在绝大多数情况下，贪心算法不能得到整体最优解，但它的解是最优解的一个很好近似。同时，也是所有讨论最优化问题的核心基础。</p> <p>既然无法通过贪心算法达到整体最优，就得换一个思路了：我们得从整体最优的层面上解决这个难缠的算法问题。</p> <h5 id="最优化问题的本质"><a href="#最优化问题的本质" class="header-anchor">#</a> 最优化问题的本质</h5> <p>所谓最优化问题，就是指在某些约束条件下，决定可选择的变量应该取何值，使所选定的目标函数达到最优的问题。</p> <p>从数学意义上说，最优化方法是一种求极值的方法，即在一组约束为等式或不等式的条件下，使系统的目标函数达到极值，即最大值或最小值。</p> <p>如果只是从概念上来看最优化问题真的是玄而又玄，所以在上一课中我用了硬币找零的例子，引出了最优化的概念，以便你理解。</p> <p>在数学里一切都是函数，现在我们先把这个问题用函数形式来表示。为了易于理解，下面我们不会使用向量。</p> <p>我们假定需要给出 $y$ 元硬币，硬币面额是5元和3元，求出需要的最少硬币数量。所谓的最少硬币数量就是5元硬币和3元硬币的总数，假定5元硬币数量为$x_{0}$，3元硬币数量为$x_{1}$，那么用函数表示就是：</p> <p>$$
f(x_{0}, x_{1})=x_{0}+x_{1}
$$</p> <p>这就是所谓的“目标函数”。</p> <p>但是这个函数现在是没有任何限制的，我们希望对此进行约束，使得5元硬币和3元硬币的面值综合为$y$。为此我们需要给出一个约束：</p> <p>$$5x_{0}+3x_{1}=y$$</p> <p>这个时候我们的问题就变成了，当满足这个约束条件的时候，求解函数中的变量$x_{0}$和$x_{1}$，使得目标函数$f(x_{0}, x_{1})$的取值最小。如果用数学的描述方法来说的话，就是下面这样：</p> <p>$${argmin}_{(x_0,x_1)in S} (x_0+x_1)$$</p> <p>这个就是我们常见的$argmin$表示方式。它的意思是：当$(x_{0}, x_{1})$属于$S$这个集合的时候，希望知道$x_{0} + x_{1}$的最小值是多少。其中$S$集合的条件就是上面的约束。</p> <p>所以最优化问题在我们生活中是非常普遍的，只不过大多数问题可能都像硬币找零问题这样看起来普普通通，概念其实是不难理解的。</p> <p>回到硬币找零这个问题上。由于$(x_{0}, x_{1})$都是离散的值，因此所有满足上述约束的$(x_{0}, x_{1})$组合，就是我们最终所求的集合！而这个最优化问题的本质就是：从所有满足条件的组合$(x_{0},x_{1})$中找出一个组合，使得$x_{0}+x_{1}$的值最小。</p> <p>所以，你会发现在这种离散型的最优化问题中，本质就是从所有满足条件的组合（能够凑出$y$元）中选择出使得我们的目标函数（所有硬币数量之和）最小的那个组合。而这个所谓满足条件的组合不就是$argmin$公式中的那个集合$S$吗？</p> <p>因此，这种离散型的最优化问题就是去所有满足条件的组合里找出最优解的组合。我曾多次提到的局部最优就是在一定条件下的最优解，而整体最优就是我们真正希望得到的最优解。</p> <p>那么我们的视角就转到另一边了：如何去找到这个最优解呢？</p> <h5 id="枚举与递归-最优组合的求解策略"><a href="#枚举与递归-最优组合的求解策略" class="header-anchor">#</a> 枚举与递归：最优组合的求解策略</h5> <p>如果想得到最优组合，那么最简单直接的方法肯定就是枚举。枚举就是直接求出所有满足条件的组合，然后看看这些组合是否能得到最大值或者最小值。</p> <p>在硬币找零问题中，假设现在需要给出25元的硬币，有两种组合，分别是(5, 0)和(2, 5)，也就是5个5元硬币，或者2个5元硬币加上5个3元硬币，那么硬币数量最小的组合肯定就是(5, 0)。</p> <p>所以最简单的方法就是找出所有满足条件的组合，也就是上面两个组合，然后去看这些组合中的最优解。</p> <p>枚举本身很简单，就是把所有组合都遍历一遍即可。可现在问题就是，如何得到这些组合呢？</p> <p>这就需要我们通过一些策略来生成所有满足条件的组合。而递归正是得到这些组合的方法。在解决问题前，我们先回顾一下递归问题的本质。</p> <h4 id="递归与问题表达"><a href="#递归与问题表达" class="header-anchor">#</a> 递归与问题表达</h4> <p>我们可以看出，其实最优化问题使用递归来处理是非常清晰的，递归是搜索组合的一种非常直观的思路。</p> <p>当我在稍后的课程里讨论动态规划时，你就会发现所有问题都需要被描述成递归的形式来讨论。</p> <p>所以我们有必要先巩固一下递归的概念。首先是在数学中我们怎么去用递归描述一个问题，然后是如何用递归描述最优化问题的解法。</p> <h5 id="从斐波那契数列说起"><a href="#从斐波那契数列说起" class="header-anchor">#</a> 从斐波那契数列说起</h5> <p>严格来说，斐波那契数列问题不是最优化问题，但它能很好地展示递归的概念。我们先来看一下斐波那契数列的问题描述。</p> <p>问题：斐波那契数通常用 F(n) 表示，形成的序列称为斐波那契数列。该数列由 0 和 1 开始，后面的每一项数字都是前面两项数字的和：</p> <p>$$F(n)=left{begin{array}{c}
0,n=0
1,n=1
F(n-1)+F(n-2),n&gt;1
end{array}right.
$$</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>示例 1：

输入：2
输出：1
解释：F(2) = F(1) + F(0) = 1 + 0 = 1。
示例 2：

输入：3
输出：2
解释：F(3) = F(2) + F(1) = 1 + 1 = 2.
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>很多人在解算法面试问题的时候有一种倾向性，那就是使用迭代而非递归来求解问题。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Java Solution</span>
<span class="token keyword">int</span> <span class="token function">fibonacci</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> resolution <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 解的数组</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> resolution<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fib1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fib2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> fib <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        fib <span class="token operator">=</span> fib1 <span class="token operator">+</span> fib2<span class="token punctuation">;</span>
        fib1 <span class="token operator">=</span> fib2<span class="token punctuation">;</span>
        fib2 <span class="token operator">=</span> fib<span class="token punctuation">;</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> fib<span class="token punctuation">;</span> <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><br><br></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// C++ Solution</span>
<span class="token keyword">int</span> <span class="token function">Fibonacci</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>vector resolution <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 解的数组</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> resolution<span class="token punctuation">[</span>n<span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>
    
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> fib1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> fib2 <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> fib <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span>i <span class="token operator">&lt;</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	fib <span class="token operator">=</span> fib1 <span class="token operator">+</span> fib2<span class="token punctuation">;</span>
    	fib1 <span class="token operator">=</span> fib2<span class="token punctuation">;</span>
    	fib2 <span class="token operator">=</span> fib<span class="token punctuation">;</span>
    	i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">return</span> fib<span class="token punctuation">;</span> <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span> 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>这样的解法固然没错，但是它几乎脱离了题设的数学表达形式。在这道题目中，出题者“刻意”地写出了求解斐波那契数列的函数表达式，这其中有没有什么别的含义或原因呢？</p> <p>当然有了，这个函数表达式很好地反应出了计算机科学中常见的算法形式：递归。下面，我们来看看斐波那契数列与递归之间的关系。</p> <h5 id="使用递归求解斐波那契数列"><a href="#使用递归求解斐波那契数列" class="header-anchor">#</a> 使用递归求解斐波那契数列</h5> <p>事实上，斐波那契数列的数学形式就是递归的，我在这里直接贴出其递归形式的算法代码：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Java Solution</span>
<span class="token keyword">int</span> <span class="token class-name">Fibonacci</span><span class="token punctuation">(</span><span class="token keyword">int</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> n <span class="token operator">||</span> <span class="token number">1</span> <span class="token operator">==</span> n<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> n<span class="token punctuation">;</span> <span class="token punctuation">}</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span>n <span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token class-name">Fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token class-name">Fibonacci</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

  <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 如果输入n有误，则返回默认值</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>递归形式的求解几乎就是简单的把题设中的函数表达式照搬过来，因此我们说从数学意义上讲，递归更直观，且易于理解。</p> <h5 id="使用递归求解硬币问题"><a href="#使用递归求解硬币问题" class="header-anchor">#</a> 使用递归求解硬币问题</h5> <p>可以看出，理解递归并不难，现在把这种思路套用到求解硬币的问题上来。</p> <p>贴出使用递归求解硬币问题的代码实现：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Java Solution</span>
<span class="token keyword">void</span> <span class="token function">getMinCountsHelper</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">,</span> <span class="token class-name">ArrayList</span> currentCounts<span class="token punctuation">,</span> <span class="token class-name">ArrayList</span><span class="token operator">&gt;</span> combinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果余额为0，说明当前组合成立，将组合加入到待选数组中</span>
        combinations<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span>currentCounts<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> valueLength <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  i <span class="token operator">&lt;</span> valueLength<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 遍历所有面值</span>
        <span class="token keyword">int</span> currentValue <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentValue <span class="token operator">&gt;</span> total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果面值大于当前总额，直接跳过</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 否则在当前面值数量组合上的对应位置加1</span>
        <span class="token class-name">ArrayList</span> newCounts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span>currentCounts<span class="token punctuation">)</span><span class="token punctuation">;</span>
        newCounts<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> newCounts<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> rest <span class="token operator">=</span> total <span class="token operator">-</span> currentValue<span class="token punctuation">;</span>

        <span class="token function">getMinCountsHelper</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> values<span class="token punctuation">,</span> newCounts<span class="token punctuation">,</span> combinations<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 求解剩余额度所需硬币数量</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getMinimumHelper</span><span class="token punctuation">(</span><span class="token class-name">ArrayList</span><span class="token operator">&gt;</span> combinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果没有可用组合，返回-1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> combinations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> minCount <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ArrayList</span> counts <span class="token operator">:</span> combinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 求当前组合的硬币总数</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> count <span class="token operator">:</span> counts<span class="token punctuation">)</span> <span class="token punctuation">{</span> total <span class="token operator">+=</span> count<span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">// 保留最小的</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>total <span class="token operator">&lt;</span> minCount<span class="token punctuation">)</span> <span class="token punctuation">{</span> minCount <span class="token operator">=</span> total<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minCount<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getMinCountOfCoins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值的数组</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总值</span>

    <span class="token class-name">ArrayList</span> initialCounts <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Collections</span><span class="token punctuation">.</span><span class="token function">nCopies</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span>length<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始值(0,0)</span>

    <span class="token class-name">ArrayList</span><span class="token operator">&gt;</span> coinCombinations <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 存储所有组合</span>
    <span class="token function">getMinCountsHelper</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> initialCounts<span class="token punctuation">,</span> coinCombinations<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 求解所有组合（不去重）</span>
    
    <span class="token keyword">return</span> <span class="token function">getMinimumHelper</span><span class="token punctuation">(</span>coinCombinations<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br></div></div><p><br><br></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// C++ Solution </span>
<span class="token keyword">void</span> <span class="token function">GetMinCountsHelper</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&amp;</span> values<span class="token punctuation">,</span> std<span class="token operator">::</span>vector currentCounts<span class="token punctuation">,</span> std<span class="token operator">::</span>vector<span class="token operator">&gt;</span><span class="token operator">&amp;</span> combinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果余额为0，说明当前组合成立，将组合加入到待选数组中</span>
        combinations<span class="token punctuation">.</span><span class="token function">push_back</span><span class="token punctuation">(</span>currentCounts<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">int</span> valueLength <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  i <span class="token operator">&lt;</span> valueLength<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 遍历所有面值</span>
        <span class="token keyword">int</span> currentValue <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentValue <span class="token operator">&gt;</span> total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果面值大于当前总额，直接跳过</span>
            <span class="token keyword">continue</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">// 否则在当前面值数量组合上的对应位置加1</span>
        std<span class="token operator">::</span>vector newCounts <span class="token operator">=</span> currentCounts<span class="token punctuation">;</span>
        newCounts<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> rest <span class="token operator">=</span> total <span class="token operator">-</span> currentValue<span class="token punctuation">;</span>
        
        <span class="token function">GetMinCountsHelper</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> values<span class="token punctuation">,</span> newCounts<span class="token punctuation">,</span> combinations<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 求解剩余额度所需硬币数量</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">GetMinimumHelper</span><span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&gt;</span><span class="token operator">&amp;</span> combinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果没有可用组合，返回-1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>combinations<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> minCount <span class="token operator">=</span> INT_MAX<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&amp;</span> counts <span class="token operator">:</span> combinations<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token comment">// 求当前组合的硬币总数</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> count <span class="token operator">:</span> counts<span class="token punctuation">)</span> <span class="token punctuation">{</span> total <span class="token operator">+=</span> count<span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token comment">// 保留最小的</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>total <span class="token operator">&lt;</span> minCount<span class="token punctuation">)</span> <span class="token punctuation">{</span> minCount <span class="token operator">=</span> total<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minCount<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">GetMinCountOfCoins</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>vector values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值的数组</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总值</span>

    std<span class="token operator">::</span>vector <span class="token function">initialCounts</span><span class="token punctuation">(</span>values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 初始值(0,0)</span>
    std<span class="token operator">::</span>vector<span class="token operator">&gt;</span> coinCombinations<span class="token punctuation">;</span> <span class="token comment">// 存储所有组合</span>
    <span class="token function">GetMinCountsHelper</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">,</span> initialCounts<span class="token punctuation">,</span> coinCombinations<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 求解所有组合（不去重）</span>

    <span class="token keyword">return</span> <span class="token function">GetMinimumHelper</span><span class="token punctuation">(</span>coinCombinations<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br></div></div><p>从代码里可以看出，这里的操作被明确分成了两步：</p> <ol><li>求解所有满足条件的组合；</li> <li>从组合中选出总和最小的组合。如果找不到满足条件的组合那么就返回-1。</li></ol> <p>我们也可以将这两步合并成一步来解决，就像下面这段代码。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// Java Solution</span>
<span class="token keyword">int</span> <span class="token function">getMinCountsHelper</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果余额为0，说明当前组合成立，将组合加入到待选数组中</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">0</span> <span class="token operator">==</span> total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> valueLength <span class="token operator">=</span> values<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
    <span class="token keyword">int</span> minCount <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  i <span class="token operator">&lt;</span> valueLength<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 遍历所有面值</span>
        <span class="token keyword">int</span> currentValue <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果当前面值大于硬币总额，那么跳过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentValue <span class="token operator">&gt;</span> total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">int</span> rest <span class="token operator">=</span> total <span class="token operator">-</span> currentValue<span class="token punctuation">;</span> <span class="token comment">// 使用当前面值，得到剩余硬币总额</span>
        <span class="token keyword">int</span> restCount <span class="token operator">=</span> <span class="token function">getMinCountsHelper</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果返回-1，说明组合不可信，跳过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>restCount <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">int</span> totalCount <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> restCount<span class="token punctuation">;</span> <span class="token comment">// 保留最小总额</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>totalCount <span class="token operator">&lt;</span> minCount<span class="token punctuation">)</span> <span class="token punctuation">{</span> minCount <span class="token operator">=</span> totalCount<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 如果没有可用组合，返回-1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minCount <span class="token operator">==</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minCount<span class="token punctuation">;</span> <span class="token comment">// 返回最小硬币数量</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">getMinCountOfCoinsAdvance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">int</span><span class="token punctuation">[</span><span class="token punctuation">]</span> values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值的数组</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总值</span>

    <span class="token keyword">return</span> <span class="token function">getMinCountsHelper</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br></div></div><p><br><br></p> <div class="language-cpp line-numbers-mode"><pre class="language-cpp"><code><span class="token comment">// C++ Solution</span>
<span class="token keyword">int</span> <span class="token function">GetMinCountsHelper</span><span class="token punctuation">(</span><span class="token keyword">int</span> total<span class="token punctuation">,</span> <span class="token keyword">const</span> std<span class="token operator">::</span>vector<span class="token operator">&amp;</span> values<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果余额为0，说明当前组合成立，将组合加入到待选数组中</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">int</span> valueLength <span class="token operator">=</span> values<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">int</span> minCount <span class="token operator">=</span> INT_MAX<span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>  i <span class="token operator">&lt;</span> valueLength<span class="token punctuation">;</span> i <span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 遍历所有面值</span>
        <span class="token keyword">int</span> currentValue <span class="token operator">=</span> values<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果当前面值大于硬币总额，那么跳过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>currentValue <span class="token operator">&gt;</span> total<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">int</span> rest <span class="token operator">=</span> total <span class="token operator">-</span> currentValue<span class="token punctuation">;</span> <span class="token comment">// 使用当前面值，得到剩余硬币总额</span>
        <span class="token keyword">int</span> restCount <span class="token operator">=</span> <span class="token function">GetMinCountsHelper</span><span class="token punctuation">(</span>rest<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// 如果返回-1，说明组合不可信，跳过</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>restCount <span class="token operator">==</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">continue</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

        <span class="token keyword">int</span> totalCount <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">+</span> restCount<span class="token punctuation">;</span> <span class="token comment">// 保留最小总额</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>totalCount <span class="token operator">&lt;</span> minCount<span class="token punctuation">)</span> <span class="token punctuation">{</span> minCount <span class="token operator">=</span> totalCount<span class="token punctuation">;</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 如果没有可用组合，返回-1</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>minCount <span class="token operator">==</span> INT_MAX<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token punctuation">}</span>

    <span class="token keyword">return</span> minCount<span class="token punctuation">;</span> <span class="token comment">// 返回最小硬币数量</span>
<span class="token punctuation">}</span>

<span class="token keyword">int</span> <span class="token function">GetMinCountOfCoinsAdvance</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    std<span class="token operator">::</span>vector values <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">3</span> <span class="token punctuation">}</span><span class="token punctuation">;</span> <span class="token comment">// 硬币面值的数组</span>
    <span class="token keyword">int</span> total <span class="token operator">=</span> <span class="token number">11</span><span class="token punctuation">;</span> <span class="token comment">// 总值</span>

    <span class="token keyword">return</span> <span class="token function">GetMinCountsHelper</span><span class="token punctuation">(</span>total<span class="token punctuation">,</span> values<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 输出答案</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p>在这段代码中，每一次递归返回的值，都是后续组合之和的最小值。它不再存储所有的组合，直到回退到递归的顶层。</p> <p>这样可以极大节省存储空间，这是处理递归问题的通用方法。一般来说，你都应该用这种算法处理方式来解递归问题。</p> <h4 id="深入理解递归"><a href="#深入理解递归" class="header-anchor">#</a> 深入理解递归</h4> <p>为什么递归能帮助我们解决最优化问题？</p> <p><strong>堆栈与递归的状态存储</strong></p> <p>在计算机中，实现递归必须建立在堆栈的基础上，这是因为每次递归调用的时候我们都需要把当前函数调用中的局部变量保存在某个特定的地方，等到函数返回的时候再把这些局部变量取出来。</p> <p>而用于保存这些局部变量的地方也就是堆栈了。</p> <p>因此，你可以看到递归可以不断保存当前求解状态并进入下一层次的求解，并在得到后续阶段的解之后，将当前求解状态恢复并与后续求解结果进行合并。</p> <p>在硬币找零问题中，我们可以放心的在函数中用循环不断遍历，找出当前面值硬币的可能数量。而无需用其它方法来存储当前或之前的数据。</p> <p>得益于递归，我们通过堆栈实现了状态存储，这样的代码看起来简单、清晰明了。在本节课稍后的内容中，在我讲到递归树的求解组合空间时，你会更清晰地认识到堆栈和状态存储带来的价值！</p> <p><strong>递归与回溯</strong></p> <p>在求解最优化问题的时候，我们经常会用到回溯这个策略。</p> <p>上一课中，我们已经提到过回溯的思想。在硬币找零这个问题里，具体说就是如果遇到已经无法求解的组合，那么我们就往回退一步，修改上一个面值的硬币数量，然后再尝试新的组合。</p> <p>递归这种形式，正是赋予了回溯这种可以回退一步的能力：它通过堆栈保存了上一步的当前状态。</p> <p>因此，如果想要用回溯的策略来解决问题，那么递归应该是你的首选方法。所以说，回溯在最优化问题中有多么重要，递归也就有多么重要。</p> <p><strong>树形结构与深度优先搜索</strong></p> <p>为了理解递归，我在这里用合适的结构来描述递归的求解过程。这种结构正是计算机数据结构中的树。如下图所示：</p> <p><img src="/images/recursion1.png" alt=""></p> <p>可以从中看到形象的递归求解过程，每个节点的 /（斜线）左边表示当前节点使用的硬币面值，右边表示使用面值后的余额。图中的蓝色节点就表示我们目前得到的解。</p> <p>递归的过程的确就是一个树形结构，而递归也就是一个深度优先搜索的过程，先找到下一步的解，然后再回退，如此往复。</p> <p>所以我们可以这样理解递归：作为一个算法解决方案，它采用了深度优先搜索的策略，去搜索所有可能的组合，并得到最优解的最优化问题。</p> <p>如果在每个节点上加上当前这个节点求得的组合结果，就可以用递归树表示<strong>求解的组合空间</strong>：</p> <p><img src="/images/recursion2.png" alt=""></p> <p><strong>通过穷举法从所有的解中得到最优解</strong></p> <p>从上图中我们可以发现，每个节点都存储了一个当前求解过程中的组合，和后续节点的组合合并到一起形成完整的答案。</p> <p>而真正的求解组合，就是把所有余额为0的组合拿出来，经过去重之后得到的结果。</p> <p>所以，你可以看到求解的组合就蕴含在这个递归的树形结算的节点空间中，这也就是为什么递归策略是行之有效的：我们可以通过穷举法从所有的解中得到最优解。</p> <h4 id="暴力递归的问题与优化"><a href="#暴力递归的问题与优化" class="header-anchor">#</a> 暴力递归的问题与优化</h4> <p><strong>性能问题</strong></p> <p>暴力递归的最后一个特点就是穷举（都叫暴力，你说是不是）。如果我们只使用朴素的递归思路解题，就需要通过递归来暴力穷举出所有的组合，而且我们穷举的不只是组合，还是所有可能得到目标组合的组成路径！</p> <p>这个在上面的图中我们可以看到，同样是求解(2, 5)这个组合，图中有多少种路径？这还只是25元和两种面值的情况。如果求解的金额和面值数量增加，那么我们可以看到这个树会以非常难以置信的方式增长，那么带来的性能问题就是灾难性的。</p> <p>如果你仔细观察一下，就会发现这个树会随着总额的增加呈现指数形式的增长。对于这种事情，我们难以接受。</p> <p>因此，递归只是让问题可以求解，但是如果数据规模过大的时候暴力递归会引发极大的性能问题。</p> <p><strong>可读性与调试问题</strong></p> <p>虽然递归在数学意义上非常直观，但是如果问题过于复杂，一般是无法直接画出上面我画的那棵求解树的。</p> <p>有画求解树的时候，我们可以想出我们的求解过程是怎么进行的，但如果求解树的分支极多，那么很多人就很难继续在脑海中模拟出整个求解过程了。</p> <p>因此，一旦程序出现bug，当你想尝试去调试的时候，就会发现这样的代码几乎没有调试的可能性。这种问题在数据规模很大的情况下尤为明显。</p> <p>那么针对性能低下、代码可读性降低和调试问题，我们有什么办法去解决吗？</p> <h5 id="优化暴力递归-剪枝与优化"><a href="#优化暴力递归-剪枝与优化" class="header-anchor">#</a> 优化暴力递归：剪枝与优化</h5> <p>你可以从前面的图中看到，这棵树中有很多分支是完全相同的：起码从理论上讲最终只有两个组合。但是这棵树到达同一种组合的路径却非常多，所以优化递归的思路其实就是如何减少搜索的分支数量。</p> <p>分支数量减少了，递归效率也就高了。这就是所谓的剪枝优化。对于优化方法，这里我提供两种思路给你。</p> <ol><li>参考贪心算法</li></ol> <p>第一种思路是仿照贪心算法，从整个搜索策略上来调整。也就是说，你要考虑这个问题的性质，即面值大的硬币用得足够多，那么这个组合的硬币总数肯定就最小。</p> <p>所以在每一次递归时，我们不应该暴力地搜索所有的面值，而应该从面值最大的硬币着手，不断尝试大面值硬币的最大情况。</p> <p>如果无法满足条件再减少一个，再递归搜索。最后的代码就跟我在上一课中写给你的回溯代码一样，即通过贪心这种思路结合递归实现一种组合搜索。</p> <p>殊途同归啊！我们从递归的角度重新解释了这个算法问题，而且代码实现也是一样的。</p> <ol start="2"><li>从解空间图解释</li></ol> <p>除了参考贪心算法的思想，我们还可以从解空间的角度来解释这个问题。</p> <p>注意观察：在解空间的图中，只要是余额相同的情况下，后面的搜索路径是完全一致的。</p> <p><img src="/images/recursion3.png" alt=""></p> <p>在图中圈出的两个部分就是重复的搜索路径。因为余额都是12元，所以后续的求解路径和结果完全相同。</p> <p>这是一个重要线索，在这个硬币求解问题中，当余额相同的时候，最优解是确定的。那么如果能够避免相同余额下的重复搜索过程，算法执行速度是不是可以加快了？</p> <p>这就是提到过的<strong>重叠子问题</strong>。可以把求解12元的硬币数量理解成求解25元的硬币数量的一个子问题。在求解25元硬币过程中，会有很多种情况都要求解12元硬币的最优解。我们把这类会出现重复求解的子问题称之为重叠子问题。</p></div> <div class="article-copyright"><ul><li class="article-copyright__item"><strong class="article-copyright__title">Last-updated: </strong> <span class="article-copyright__text">2 months ago</span></li> <li class="article-copyright__item"><strong class="article-copyright__title">Link: </strong> <span class="article-copyright__text"><a href="/post/2021/09/20/algorithms-dynamicprogramming.html" title="动态规划">/post/2021/09/20/algorithms-dynamicprogramming.html</a></span></li></ul></div> <!----></div> <div class="article-footer"><ul class="post-tag"><li class="post-tag__item"><a href="/tags/代码之美"><span># 代码之美</span></a></li></ul> <div class="post-operate"><a href="/post/2021/09/17/data-structure.html" class="post-operate__prev">Data Structure Overview</a> <a href="/post/2021/09/22/algorithms-memorization.html" class="post-operate__next">递归优化</a></div> <!----></div></article></div></div> <svg style="display:none;"><symbol id="theme-icon-auto" viewBox="0 0 32 32"><path d="M16 0c-8.837 0-16 7.163-16 16s7.163 16 16 16 16-7.163 16-16-7.163-16-16-16zM4 16c0-6.627 5.373-12 12-12v24c-6.627 0-12-5.373-12-12z"></path></symbol> <symbol id="theme-icon-sun" viewBox="0 0 32 32"><path d="M16 26c1.105 0 2 0.895 2 2v2c0 1.105-0.895 2-2 2s-2-0.895-2-2v-2c0-1.105 0.895-2 2-2zM16 6c-1.105 0-2-0.895-2-2v-2c0-1.105 0.895-2 2-2s2 0.895 2 2v2c0 1.105-0.895 2-2 2zM30 14c1.105 0 2 0.895 2 2s-0.895 2-2 2h-2c-1.105 0-2-0.895-2-2s0.895-2 2-2h2zM6 16c0 1.105-0.895 2-2 2h-2c-1.105 0-2-0.895-2-2s0.895-2 2-2h2c1.105 0 2 0.895 2 2zM25.899 23.071l1.414 1.414c0.781 0.781 0.781 2.047 0 2.828s-2.047 0.781-2.828 0l-1.414-1.414c-0.781-0.781-0.781-2.047 0-2.828s2.047-0.781 2.828 0zM6.101 8.929l-1.414-1.414c-0.781-0.781-0.781-2.047 0-2.828s2.047-0.781 2.828 0l1.414 1.414c0.781 0.781 0.781 2.047 0 2.828s-2.047 0.781-2.828 0zM25.899 8.929c-0.781 0.781-2.047 0.781-2.828 0s-0.781-2.047 0-2.828l1.414-1.414c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-1.414 1.414zM6.101 23.071c0.781-0.781 2.047-0.781 2.828 0s0.781 2.047 0 2.828l-1.414 1.414c-0.781 0.781-2.047 0.781-2.828 0s-0.781-2.047 0-2.828l1.414-1.414z"></path> <path d="M16 8c-4.418 0-8 3.582-8 8s3.582 8 8 8c4.418 0 8-3.582 8-8s-3.582-8-8-8zM16 21c-2.761 0-5-2.239-5-5s2.239-5 5-5 5 2.239 5 5-2.239 5-5 5z"></path></symbol> <symbol id="theme-icon-moon" viewBox="0 0 18 18"><path d="M7.246 3.255c-0.251 0.828-0.322 1.71-0.198 2.597 0.366 2.63 2.455 4.723 5.080 5.089 0.282 0.040 0.568 0.060 0.85 0.060 0.599 0 1.184-0.087 1.742-0.257-0.674 2.215-2.642 3.926-4.973 4.21-0.254 0.031-0.51 0.047-0.762 0.047-1.713 0-3.349-0.738-4.486-2.024-1.152-1.304-1.669-2.987-1.457-4.739 0.284-2.335 1.992-4.307 4.204-4.982zM8.985 1c-0.362 0-0.731 0.024-1.104 0.075-3.543 0.48-6.388 3.364-6.82 6.92-0.592 4.867 3.184 9.005 7.924 9.005 0.33 0 0.665-0.020 1.003-0.062 3.549-0.433 6.428-3.283 6.907-6.833 0.052-0.383 0.076-0.761 0.075-1.134-0.002-0.583-0.482-0.972-0.996-0.972-0.209 0-0.424 0.065-0.614 0.207-0.665 0.498-1.489 0.793-2.383 0.793-0.188 0-0.38-0.013-0.574-0.040-1.732-0.242-3.137-1.649-3.378-3.385-0.155-1.115 0.149-2.156 0.751-2.963 0.415-0.657 0.025-1.609-0.764-1.612-0.009 0-0.018 0-0.028 0v0z"></path></symbol> <symbol id="theme-icon-palette" viewBox="0 0 1024 1024"><path d="M745.984 512q25.984 0 45.013333-18.005333t18.986667-45.994667-18.986667-45.994667-45.013333-18.005333-45.013333 18.005333-18.986667 45.994667 18.986667 45.994667 45.013333 18.005333zM617.984 342.016q25.984 0 45.013333-18.986667t18.986667-45.013333-18.986667-45.013333-45.013333-18.986667-45.013333 18.986667-18.986667 45.013333 18.986667 45.013333 45.013333 18.986667zM406.016 342.016q25.984 0 45.013333-18.986667t18.986667-45.013333-18.986667-45.013333-45.013333-18.986667-45.013333 18.986667-18.986667 45.013333 18.986667 45.013333 45.013333 18.986667zM278.016 512q25.984 0 45.013333-18.005333t18.986667-45.994667-18.986667-45.994667-45.013333-18.005333-45.013333 18.005333-18.986667 45.994667 18.986667 45.994667 45.013333 18.005333zM512 128q157.994667 0 271.018667 100.010667t112.981333 242.005333q0 88.021333-63.018667 150.016t-150.997333 61.994667l-73.984 0q-27.989333 0-45.994667 18.986667t-18.005333 45.013333q0 22.016 16 41.984t16 43.989333q0 27.989333-18.005333 45.994667t-45.994667 18.005333q-160 0-272-112t-112-272 112-272 272-112z" p-id="10529"></path></symbol> </svg> <div class="shadow-box"></div></div><div class="global-ui"><div class="float-menu-wrap"><!----> <div class="float-menu__list"><span class="icon-up"></span> <span title="auto" class="theme-mode-setting"><svg class="theme-icon theme-icon-auto"><use xlink:href="#theme-icon-auto"></use></svg></span> <!----> <span class="icon-toc"></span> <span class="icon-search"></span></div> <div class="float-menu"><svg width="100%" height="100%" class="float-menu__progress"><circle stroke-dasharray="0% 301.59289474462014%" stroke="currentcolor" stroke-width="2%" fill="none" r="48%" cx="50%" cy="50%"></circle></svg> <div class="float-menu__dot"></div></div></div><div class="theme-search" style="display:none;"><div class="theme-search__inner"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <a class="icon-exit"></a></div></div></div></div>
    <script src="/assets/js/app.ea9d4954.js" defer></script><script src="/assets/js/4.28869c9a.js" defer></script><script src="/assets/js/9.bd309bf5.js" defer></script><script src="/assets/js/17.bc4d0f2d.js" defer></script>
  </body>
</html>